# .htaccess V20.0 - Fix Index.php/html + SEO Full
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # ----------------------------------------------------------------------
    # 0. LIMPIEZA DE HOME (FIX INDEX.PHP / INDEX.HTML) - NUEVO
    # ----------------------------------------------------------------------
    # Si alguien pide /index.php o /index.html explícitamente, mandar a la raíz /
    
    # Redirigir index.php a /
    RewriteCond %{THE_REQUEST} ^.*/index\.php [NC]
    RewriteRule ^(.*)index\.php$ /$1 [R=301,L]

    # Redirigir index.html a / (Evita que urls viejas o errores generen contenido duplicado)
    RewriteCond %{THE_REQUEST} ^.*/index\.html [NC]
    RewriteRule ^(.*)index\.html$ /$1 [R=301,L]

    # ----------------------------------------------------------------------
    # 1. URLs ESTRATÉGICAS (HOY / MAÑANA)
    # ----------------------------------------------------------------------
    # Hoy
    RewriteRule ^pico-y-placa-bogota-hoy/?$ index.php?special_slug=hoy [L,QSA]
    
    # Mañana (Acepta: mañana, manana, ma%C3%B1ana)
    RewriteRule ^pico-y-placa-bogota-ma(n|ñ|%C3%B1)ana/?$ index.php?special_slug=manana [L,QSA,NC]

    # ----------------------------------------------------------------------
    # 2. MIGRACIÓN SEO (REDIRECCIONES 301)
    # ----------------------------------------------------------------------
    # Redirigir tráfico antiguo a la nueva estructura limpia
    RewriteCond %{REQUEST_URI} ^/pico-y-placa/([a-z-]+)-([0-9]{1,2})-de-([a-z]+)-de-([0-9]{4})/(.+)$
    RewriteRule ^pico-y-placa/([a-z-]+)-([0-9]{1,2})-de-([a-z]+)-de-([0-9]{4})/(.+)$ https://picoyplacabogota.com.co/pico-y-placa/$1-$2-de-$3-de-$4 [R=301,L]

    # Forzar HTTPS
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://picoyplacabogota.com.co/$1 [R=301,L]

    # ----------------------------------------------------------------------
    # 3. ENRUTAMIENTO DE FECHAS (URL SIMPLIFICADA)
    # ----------------------------------------------------------------------
    # Ejemplo: /pico-y-placa/bogota-4-de-diciembre-de-2025
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^pico-y-placa/([a-z-]+)-([0-9]{1,2})-de-([a-z]+)-de-([0-9]{4})/?$ index.php?ciudad_slug=$1&dia=$2&mes_nombre=$3&ano=$4 [L,QSA]

    # Fallback (Todo lo demás va a index.php)
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php [L,QSA] 

</IfModule>

<IfModule mod_headers.c>
    Header set Content-Type "text/html; charset=utf-8"
    <FilesMatch "\.(css|js|png|jpg|jpeg|svg|ico)$">
        Header set Cache-Control "max-age=604800, public"
    </FilesMatch>
</IfModule>
AddDefaultCharset UTF-8